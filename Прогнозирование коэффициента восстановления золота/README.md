## Прогнозирование коэффициента восстановления золота

Компания «Цифры» разрабатывает решения для эффективной работы промышленных предприятий.

**Цель исследования** - подготовить прототип модели машинного обучения, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды. Это поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

**Ход исследования**

Данные  с параметрами добычи и очистки золота из золотосодержащей руды мы получили из 3-х файлов - исходного (полного), тестового и тренировочного. Мы проверим данные на корректность, что эффективность обогащения рассчитана правильно, проанализируем признаки, недоступные в тестовой выборке, проведём предобработку. Затем исследуем данные -  посмотрим, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах, сравним распределения размеров гранул исходного сырья на обучающей и тестовой выборках, исследуем суммарную концентрацию металлов на разных стадиях. Далее, перейдём к построению моделей - напишем функцию для вычисления итоговой sMAPE, обучим разные модели и оценим их качество кросс-валидацией, выберем лучшую и проверим её на тестовой выборке. Опишим выводы. 

**Используемые библиотеки**
- `Pandas`
- `NumPy`
- `Seaborn`
- `Matplotlib`
- `Scikit-learn`    
 
###  Вывод  

- Рассмотрели датасеты `train`, `test`, `full`
- Обработали пропуски и аномалии в данных
- Подтвердили корректность расчётов эффективности обогащения золотоносной руды
- Построили графики концентраций веществ на различных этапах технологического процесса
- Написали функцию для вычисления итоговой sMAPE

При помощи RandomizedSearchCV определили гиперпараметры для "деревянных" алгоритмов, применили масштабирование StandardScaler для численных признаков, построили  модели: Дерево решений, Случайный лес, Линейная регрессия - оценено их качество кросс-валидацией.  

Лучшими моделями на тренировочной выборке показали себя:
- RandomForestRegressor rougher {'n_estimators': 150, 'min_samples_leaf': 3, 'max_depth': 5} с результатом sMAPE RandomForestRegressor rougher: 6.2976602832640545
- RandomForestRegressor final {'n_estimators': 150, 'min_samples_leaf': 3, 'max_depth': 5} с результатом sMAPE RandomForestRegressor final: 9.053494623547007  

Проведена проверка адекватности моделей. Результаты случайной модели:
- sMAPE rougher DummyRegressor: 7.7529520790224735
- sMAPE final DummyRegressor: 10.258921903524795
Обе модели подтвердили адекватность.

**На тестовой выборке итоговое sMAPE лучшей модели: 9.318421064804225** 
